import{a3 as U,X as y,_ as x,Z as O,R as D,W as z,V,Y as K,$ as I,a0 as B,a1 as L,a2 as Q,U as $,T as P}from"./index-EChXCoxk.js";import{t as _}from"./toUtf8.browser-CyauOOnS.js";import{f as M,t as j,d as W}from"./ChatPage-Cl_fa1cT.js";function C(a){return encodeURIComponent(a).replace(/[!'()*]/g,function(r){return"%"+r.charCodeAt(0).toString(16).toUpperCase()})}const S="(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun)(?:[ne|u?r]?s?day)?",b="(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)",N="(\\d?\\d):(\\d{2}):(\\d{2})(?:\\.(\\d+))?",A="(\\d?\\d)",k="(\\d{4})",J=new RegExp(/^(\d{4})-(\d\d)-(\d\d)[tT](\d\d):(\d\d):(\d\d)(\.(\d+))?(([-+]\d\d:\d\d)|[zZ])$/),X=new RegExp(`^${S}, ${A} ${b} ${k} ${N} GMT$`),Z=new RegExp(`^${S}, ${A}-${b}-(\\d\\d) ${N} GMT$`),H=new RegExp(`^${S} ${b} ( [1-9]|\\d\\d) ${N} ${k}$`),q=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Y=a=>{if(a==null)return;let r=NaN;if(typeof a=="number")r=a;else if(typeof a=="string"){if(!/^-?\d*\.?\d+$/.test(a))throw new TypeError("parseEpochTimestamp - numeric string invalid.");r=Number.parseFloat(a)}else typeof a=="object"&&a.tag===1&&(r=a.value);if(isNaN(r)||Math.abs(r)===1/0)throw new TypeError("Epoch timestamps must be valid finite numbers.");return new Date(Math.round(r*1e3))},G=a=>{if(a==null)return;if(typeof a!="string")throw new TypeError("RFC3339 timestamps must be strings");const r=J.exec(a);if(!r)throw new TypeError(`Invalid RFC3339 timestamp format ${a}`);const[,e,t,s,i,n,o,,c,m]=r;l(t,1,12),l(s,1,31),l(i,0,23),l(n,0,59),l(o,0,60);const d=new Date(Date.UTC(Number(e),Number(t)-1,Number(s),Number(i),Number(n),Number(o),Number(c)?Math.round(parseFloat(`0.${c}`)*1e3):0));if(d.setUTCFullYear(Number(e)),m.toUpperCase()!="Z"){const[,f,u,h]=/([+-])(\d\d):(\d\d)/.exec(m)||[void 0,"+",0,0],g=f==="-"?1:-1;d.setTime(d.getTime()+g*(Number(u)*60*60*1e3+Number(h)*60*1e3))}return d},v=a=>{if(a==null)return;if(typeof a!="string")throw new TypeError("RFC7231 timestamps must be strings.");let r,e,t,s,i,n,o,c;if((c=X.exec(a))?[,r,e,t,s,i,n,o]=c:(c=Z.exec(a))?([,r,e,t,s,i,n,o]=c,t=(Number(t)+1900).toString()):(c=H.exec(a))&&([,e,r,s,i,n,o,t]=c),t&&n){const m=Date.UTC(Number(t),q.indexOf(e),Number(r),Number(s),Number(i),Number(n),o?Math.round(parseFloat(`0.${o}`)*1e3):0);l(r,1,31),l(s,0,23),l(i,0,59),l(n,0,60);const d=new Date(m);return d.setUTCFullYear(Number(t)),d}throw new TypeError(`Invalid RFC7231 date-time value ${a}.`)};function l(a,r,e){const t=Number(a);if(t<r||t>e)throw new Error(`Value ${t} out of range [${r}, ${e}]`)}const ee=a=>{const r=a.length,e=[];let t=!1,s,i=0;for(let n=0;n<r;++n){const o=a[n];switch(o){case'"':s!=="\\"&&(t=!t);break;case",":t||(e.push(a.slice(i,n)),i=n+1);break}s=o}return e.push(a.slice(i)),e.map(n=>{n=n.trim();const o=n.length;return o<2?n:(n[0]==='"'&&n[o-1]==='"'&&(n=n.slice(1,o-1)),n.replace(/\\"/g,'"'))})};class te extends U{settings;constructor(r){super(),this.settings=r}read(r,e){const t=y.of(r);if(t.isListSchema())return ee(e).map(s=>this.read(t.getValueSchema(),s));if(t.isBlobSchema())return(this.serdeContext?.base64Decoder??M)(e);if(t.isTimestampSchema())switch(x(t,this.settings)){case 5:return G(e);case 6:return v(e);case 7:return Y(e);default:return console.warn("Missing timestamp format, parsing value with Date constructor:",e),new Date(e)}if(t.isStringSchema()){const s=t.getMergedTraits().mediaType;let i=e;if(s)return t.getMergedTraits().httpHeader&&(i=this.base64ToUtf8(i)),(s==="application/json"||s.endsWith("+json"))&&(i=O.from(i)),i}return t.isNumericSchema()?Number(e):t.isBigIntegerSchema()?BigInt(e):t.isBigDecimalSchema()?new D(e,"bigDecimal"):t.isBooleanSchema()?String(e).toLowerCase()==="true":e}base64ToUtf8(r){return(this.serdeContext?.utf8Encoder??_)((this.serdeContext?.base64Decoder??M)(r))}}const F=a=>{const r="#text";for(const e in a)a.hasOwnProperty(e)&&a[e][r]!==void 0?a[e]=a[e][r]:typeof a[e]=="object"&&a[e]!==null&&(a[e]=F(a[e]));return a};let w;function re(a){w||(w=new DOMParser);const r=w.parseFromString(a,"application/xml");if(r.getElementsByTagName("parsererror").length>0)throw new Error("DOMParser XML parsing error.");const e=t=>{if(t.nodeType===Node.TEXT_NODE&&t.textContent?.trim())return t.textContent;if(t.nodeType===Node.ELEMENT_NODE){const s=t;if(s.attributes.length===0&&s.childNodes.length===0)return"";const i={},n=Array.from(s.attributes);for(const c of n)i[`${c.name}`]=c.value;const o=Array.from(s.childNodes);for(const c of o){const m=e(c);if(m!=null){const d=c.nodeName;if(o.length===1&&n.length===0&&d==="#text")return m;i[d]?Array.isArray(i[d])?i[d].push(m):i[d]=[i[d],m]:i[d]=m}else if(o.length===1&&n.length===0)return s.textContent}return i}return null};return{[r.documentElement.nodeName]:e(r.documentElement)}}class se extends z{settings;stringDeserializer;constructor(r){super(),this.settings=r,this.stringDeserializer=new te(r)}setSerdeContext(r){this.serdeContext=r,this.stringDeserializer.setSerdeContext(r)}read(r,e,t){const s=y.of(r),i=s.getMemberSchemas();if(s.isStructSchema()&&s.isMemberSchema()&&!!Object.values(i).find(m=>!!m.getMemberTraits().eventPayload)){const m={},d=Object.keys(i)[0];return i[d].isBlobSchema()?m[d]=e:m[d]=this.read(i[d],e),m}const o=(this.serdeContext?.utf8Encoder??V)(e),c=this.parseXml(o);return this.readSchema(r,t?c[t]:c)}readSchema(r,e){const t=y.of(r);if(t.isUnitSchema())return;const s=t.getMergedTraits();if(t.isListSchema()&&!Array.isArray(e))return this.readSchema(t,[e]);if(e==null)return e;if(typeof e=="object"){const i=!!s.sparse,n=!!s.xmlFlattened;if(t.isListSchema()){const c=t.getValueSchema(),m=[],d=c.getMergedTraits().xmlName??"member",f=n?e:(e[0]??e)[d],u=Array.isArray(f)?f:[f];for(const h of u)(h!=null||i)&&m.push(this.readSchema(c,h));return m}const o={};if(t.isMapSchema()){const c=t.getKeySchema(),m=t.getValueSchema();let d;n?d=Array.isArray(e)?e:[e]:d=Array.isArray(e.entry)?e.entry:[e.entry];const f=c.getMergedTraits().xmlName??"key",u=m.getMergedTraits().xmlName??"value";for(const h of d){const g=h[f],p=h[u];(p!=null||i)&&(o[g]=this.readSchema(m,p))}return o}if(t.isStructSchema()){const c=t.isUnionSchema();let m;c&&(m=new K(e,o));for(const[d,f]of t.structIterator()){const u=f.getMergedTraits(),h=u.httpPayload?u.xmlName??f.getName():f.getMemberTraits().xmlName??d;c&&m.mark(h),e[h]!=null&&(o[d]=this.readSchema(f,e[h]))}return c&&m.writeUnknown(),o}if(t.isDocumentSchema())return e;throw new Error(`@aws-sdk/core/protocols - xml deserializer unhandled schema type for ${t.getName(!0)}`)}return t.isListSchema()?[]:t.isMapSchema()||t.isStructSchema()?{}:this.stringDeserializer.read(t,e)}parseXml(r){if(r.length){let e;try{e=re(r)}catch(n){throw n&&typeof n=="object"&&Object.defineProperty(n,"$responseBodyText",{value:r}),n}const t="#text",s=Object.keys(e)[0],i=e[s];return i[t]&&(i[s]=i[t],delete i[t]),F(i)}return{}}}class ie extends z{settings;buffer;constructor(r){super(),this.settings=r}write(r,e,t=""){this.buffer===void 0&&(this.buffer="");const s=y.of(r);if(t&&!t.endsWith(".")&&(t+="."),s.isBlobSchema())(typeof e=="string"||e instanceof Uint8Array)&&(this.writeKey(t),this.writeValue((this.serdeContext?.base64Encoder??j)(e)));else if(s.isBooleanSchema()||s.isNumericSchema()||s.isStringSchema())e!=null?(this.writeKey(t),this.writeValue(String(e))):s.isIdempotencyToken()&&(this.writeKey(t),this.writeValue(I()));else if(s.isBigIntegerSchema())e!=null&&(this.writeKey(t),this.writeValue(String(e)));else if(s.isBigDecimalSchema())e!=null&&(this.writeKey(t),this.writeValue(e instanceof D?e.string:String(e)));else if(s.isTimestampSchema()){if(e instanceof Date)switch(this.writeKey(t),x(s,this.settings)){case 5:this.writeValue(e.toISOString().replace(".000Z","Z"));break;case 6:this.writeValue(W(e));break;case 7:this.writeValue(String(e.getTime()/1e3));break}}else if(s.isDocumentSchema())Array.isArray(e)?this.write(79,e,t):e instanceof Date?this.write(4,e,t):e instanceof Uint8Array?this.write(21,e,t):e&&typeof e=="object"?this.write(143,e,t):(this.writeKey(t),this.writeValue(String(e)));else if(s.isListSchema()){if(Array.isArray(e))if(e.length===0)this.settings.serializeEmptyLists&&(this.writeKey(t),this.writeValue(""));else{const i=s.getValueSchema(),n=this.settings.flattenLists||s.getMergedTraits().xmlFlattened;let o=1;for(const c of e){if(c==null)continue;const m=this.getKey("member",i.getMergedTraits().xmlName),d=n?`${t}${o}`:`${t}${m}.${o}`;this.write(i,c,d),++o}}}else if(s.isMapSchema()){if(e&&typeof e=="object"){const i=s.getKeySchema(),n=s.getValueSchema(),o=s.getMergedTraits().xmlFlattened;let c=1;for(const[m,d]of Object.entries(e)){if(d==null)continue;const f=this.getKey("key",i.getMergedTraits().xmlName),u=o?`${t}${c}.${f}`:`${t}entry.${c}.${f}`,h=this.getKey("value",n.getMergedTraits().xmlName),g=o?`${t}${c}.${h}`:`${t}entry.${c}.${h}`;this.write(i,m,u),this.write(n,d,g),++c}}}else if(s.isStructSchema()){if(e&&typeof e=="object"){let i=!1;for(const[n,o]of s.structIterator()){if(e[n]==null&&!o.isIdempotencyToken())continue;const c=this.getKey(n,o.getMergedTraits().xmlName),m=`${t}${c}`;this.write(o,e[n],m),i=!0}if(!i&&s.isUnionSchema()){const{$unknown:n}=e;if(Array.isArray(n)){const[o,c]=n,m=`${t}${o}`;this.write(15,c,m)}}}}else if(!s.isUnitSchema())throw new Error(`@aws-sdk/core/protocols - QuerySerializer unrecognized schema type ${s.getName(!0)}`)}flush(){if(this.buffer===void 0)throw new Error("@aws-sdk/core/protocols - QuerySerializer cannot flush with nothing written to buffer.");const r=this.buffer;return delete this.buffer,r}getKey(r,e){const t=e??r;return this.settings.capitalizeKeys?t[0].toUpperCase()+t.slice(1):t}writeKey(r){r.endsWith(".")&&(r=r.slice(0,r.length-1)),this.buffer+=`&${C(r)}=`}writeValue(r){this.buffer+=C(r)}}class ce extends B{options;serializer;deserializer;mixin=new L;constructor(r){super({defaultNamespace:r.defaultNamespace}),this.options=r;const e={timestampFormat:{useTrait:!0,default:5},httpBindings:!1,xmlNamespace:r.xmlNamespace,serviceNamespace:r.defaultNamespace,serializeEmptyLists:!0};this.serializer=new ie(e),this.deserializer=new se(e)}getShapeId(){return"aws.protocols#awsQuery"}setSerdeContext(r){this.serializer.setSerdeContext(r),this.deserializer.setSerdeContext(r)}getPayloadCodec(){throw new Error("AWSQuery protocol has no payload codec.")}async serializeRequest(r,e,t){const s=await super.serializeRequest(r,e,t);s.path.endsWith("/")||(s.path+="/"),Object.assign(s.headers,{"content-type":"application/x-www-form-urlencoded"}),(Q(r.input)==="unit"||!s.body)&&(s.body="");const i=r.name.split("#")[1]??r.name;return s.body=`Action=${i}&Version=${this.options.version}`+s.body,s.body.endsWith("&")&&(s.body=s.body.slice(-1)),s}async deserializeResponse(r,e,t){const s=this.deserializer,i=y.of(r.output),n={};if(t.statusCode>=300){const f=await $(t.body,e);f.byteLength>0&&Object.assign(n,await s.read(15,f)),await this.handleError(r,e,t,n,this.deserializeMetadata(t))}for(const f in t.headers){const u=t.headers[f];delete t.headers[f],t.headers[f.toLowerCase()]=u}const o=r.name.split("#")[1]??r.name,c=i.isStructSchema()&&this.useNestedResult()?o+"Result":void 0,m=await $(t.body,e);return m.byteLength>0&&Object.assign(n,await s.read(i,m,c)),{$metadata:this.deserializeMetadata(t),...n}}useNestedResult(){return!0}async handleError(r,e,t,s,i){const n=this.loadQueryErrorCode(t,s)??"Unknown",o=this.loadQueryError(s),c=this.loadQueryErrorMessage(s);o.message=c,o.Error={Type:o.Type,Code:o.Code,Message:c};const{errorSchema:m,errorMetadata:d}=await this.mixin.getErrorSchemaOrThrowBaseException(n,this.options.defaultNamespace,t,o,i,this.mixin.findQueryCompatibleError),f=y.of(m),u=P.for(m[1]).getErrorCtor(m)??Error,h=new u(c),g={Type:o.Error.Type,Code:o.Error.Code,Error:o.Error};for(const[p,T]of f.structIterator()){const E=T.getMergedTraits().xmlName??p,R=o[E]??s[E];g[p]=this.deserializer.readSchema(T,R)}throw this.mixin.decorateServiceException(Object.assign(h,d,{$fault:f.getMergedTraits().error,message:c},g),s)}loadQueryErrorCode(r,e){const t=(e.Errors?.[0]?.Error??e.Errors?.Error??e.Error)?.Code;if(t!==void 0)return t;if(r.statusCode==404)return"NotFound"}loadQueryError(r){return r.Errors?.[0]?.Error??r.Errors?.Error??r.Error}loadQueryErrorMessage(r){const e=this.loadQueryError(r);return e?.message??e?.Message??r.message??r.Message??"Unknown"}getDefaultContentType(){return"application/x-www-form-urlencoded"}}export{ce as A};
